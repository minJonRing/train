(self.webpackChunkreact_app=self.webpackChunkreact_app||[]).push([[141],{6141:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return b}});var r=t(9439),u=t(2791),i=t(8530),a=t(7507),o=t(7689),c=t(1087),s=t(7621),l=t(9504),f=t(890),d=t(1918),v=function(e){return new Promise((function(n){var t=document.createElement("script");t.src=e,t.type="text/javascript",t.async=!0,document.body.appendChild(t),t.onload=function(){n()}}))},p=t(4973),m=t(4254),y=function(){var e=null;return function(n){var t=60*n*1e3,i=(0,u.useState)(!1),a=(0,r.Z)(i,2),o=a[0],c=a[1],s=function(){c(!1),clearTimeout(e),e=setTimeout((function(){c(!0)}),t)};return(0,u.useEffect)((function(){return document.addEventListener("keydown",s),document.addEventListener("mousemove",s),function(){document.removeEventListener("keydown",s),document.removeEventListener("mousemove",s),clearInterval(e)}}),[]),clearTimeout(e),e=setTimeout((function(){c(!0)}),t),{stop:o}}}(),h=t(1428),g=t(6633),x=t(184),Z=function(e){var n=e.title,a=e.isComplete,c=e.rate,Z=e.videoInfo,b=e.timeout,j=(0,o.UO)(),q=j.id,E=j.videoId,w=(0,u.useRef)(null),I=(0,u.useRef)(null),k=(0,u.useState)(c),S=(0,r.Z)(k,2),L=S[0],P=S[1],C=(0,u.useState)(!!a),D=(0,r.Z)(C,2),F=D[0],K=D[1],U=y(b).stop,T=function(){var e=(0,u.useState)(!1),n=(0,r.Z)(e,2),t=n[0],i=n[1],a=function(e){if(window){var n=(e=e||window.event).relatedTarget||e.toElement;i(!n)}};return(0,u.useEffect)((function(){return window.addEventListener("mouseout",a),document.addEventListener("mouseleave",a),document.addEventListener("mouseenter",a),function(){window.removeEventListener("mouseout",a),document.removeEventListener("mouseleave",a),document.removeEventListener("mouseenter",a)}}),[]),{leave:t}}(),N=T.leave,V=(0,u.useMemo)((function(){return!U&&!N}),[U,N]);(0,u.useEffect)((function(){var e;V||(null===(e=w.current)||void 0===e||e.pause())}),[V]);var _=(0,u.useState)(0),M=(0,r.Z)(_,2),O=M[0],R=M[1];(0,u.useEffect)((function(){return B(),function(){var e,n;null===(e=w.current)||void 0===e||e.on("timeupdate",z),null===(n=w.current)||void 0===n||n.on("ended",H)}}),[]);var B=function(){v("https://g.alicdn.com/de/prismplayer/2.9.3/aliplayer-h5-min.js").then((function(){var e=function(){return R(Z.seek||0),Z.seek};t.e(924).then(t.bind(t,8924)).then((function(){var n,t;w.current=new Aliplayer({id:"player",width:"100%",source:JSON.stringify({OD:null===Z||void 0===Z?void 0:Z.playURL}),defaultDefinition:"OD",cover:null===Z||void 0===Z?void 0:Z.cover,encryptType:1,disableSeek:!0,useH5Prism:!0,controlBarVisibility:"always",preload:!0,diagnosisButtonVisible:!1,playsinline:!0,components:[{name:"MemoryPlayComponent",type:AliPlayerComponent.MemoryPlayComponent,args:[e]}],skinLayout:[{name:"bigPlayButton",align:"blabs",x:30,y:80},{name:"H5Loading",align:"cc"},{name:"errorDisplay",align:"tlabs",x:0,y:0},{name:"infoDisplay"},{name:"tooltip",align:"blabs",x:0,y:56},{name:"thumbnail"},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"progress",align:"blabs",x:0,y:44},{name:"playButton",align:"tl",x:15,y:12},{name:"timeDisplay",align:"tl",x:10,y:7},{name:"fullScreenButton",align:"tr",x:10,y:12},{name:"volume",align:"tr",x:5,y:10}]}]}),null===(n=w.current)||void 0===n||n.on("timeupdate",z),null===(t=w.current)||void 0===t||t.on("ended",H)}))}))},A=function(e){var n,t=null===(n=w.current)||void 0===n?void 0:n.getCurrentTime();if(t&&E&&q){var r=t-O,u=Math.ceil(r<0?0:r>120?60:r,2);(0,p.hj)({url:"/personnelVideoWatch",method:"post",data:{videoId:E,seek:t,watchTime:u,courseId:q}}).then((function(e){var n=e.data;if(n){var t,r=n.isComplete,u=n.rate;if(P(u),1===r)K(1),null===(t=m.N.current)||void 0===t||t.open({message:"\u60a8\u5df2\u5b8c\u6210\u672c\u8bfe\u7a0b\u5b66\u4e60",type:"success"})}})).finally((function(){R(e?0:t)}))}},z=function(){var e=!1,n=0;setInterval((function(){n++}),1e3);return function(){e?(A(),e=!1):n>=60&&(e=!0,n=0)}}(),H=function(){A(!0)};return(0,x.jsxs)(i.Z,{sx:{height:"100%"},children:[(0,x.jsx)(s.Z,{sx:{mb:1},children:(0,x.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"space-between",p:"8px !important"},children:[(0,x.jsx)(f.Z,{variant:"h6",className:"over",color:"text.secondary",children:n}),(0,x.jsx)(d.Z,{label:L,color:F?"success":"warning",icon:F?(0,x.jsx)(h.Z,{}):(0,x.jsx)(g.Z,{})})]})}),(0,x.jsx)(i.Z,{sx:{height:"calc(100% - 60px)"},children:(0,x.jsx)(i.Z,{ref:I,id:"player-box",children:(0,x.jsx)("video",{ref:w,id:"player","webkit-playsinline":"true","x-webkit-airplay":"allow","x5-video-player-type":"h5","x5-video-player-fullscreen":"true",style:{height:"100%",overflow:"hidden"}})})})]})},b=function(){var e=(0,o.UO)(),n=e.id,t=e.videoId,s=(0,c.lr)(),l=(0,r.Z)(s,1)[0].get("timeout"),f=(0,o.s0)(),d=(0,a.ZR)({variables:{id:n,videoId:t},cacheTime:0}).data,v=(0,u.useState)(""),y=(0,r.Z)(v,2),h=y[0],g=y[1],b=(0,u.useState)(""),j=(0,r.Z)(b,2),q=j[0],E=j[1];return(0,u.useEffect)((function(){var e=d.status,n=d.msg,t=d.data;if(200===e){var r=t.aliyunVideoId,u=t.title;E(u),(0,p.hj)({url:"/video/playInfo/".concat(r)}).then((function(e){var n=e.data,t=n.code,r=n.playInfo.playInfoList[0].playURL,u="".concat(r,"?MtsHlsUriToken=").concat(t);g(u)}))}else m.N.current.open({message:n,type:"error"}),f(-1)}),[d]),(0,x.jsx)(i.Z,{sx:{height:"100%",p:1,backgroundColor:"#f5f5f5"},children:h?(0,x.jsx)(Z,{title:q,isComplete:null===d||void 0===d?void 0:d.data.isComplete,rate:null===d||void 0===d?void 0:d.data.rate,videoInfo:{cover:null===d||void 0===d?void 0:d.data.cover,seek:null===d||void 0===d?void 0:d.data.seek,playURL:h},timeout:l}):null})}},4973:function(e,n,t){"use strict";t.d(n,{hj:function(){return f},$A:function(){return d}});var r=t(9439),u=t(1413),i=t(1912),a=t(7066),o=t(4254),c=i.Z.create({baseURL:"/learning/api",timeout:6e9});c.interceptors.request.use((function(e){return a.h.user.token&&(e.headers.token=a.h.user.token),e}),(function(e){return Promise.reject(e)})),c.interceptors.response.use((function(e){var n,t,r=e.data,u=r.size,i=r.msg,a=r.status;return u||[200].includes(a)||(null===o.N||void 0===o.N||null===(n=o.N.current)||void 0===n||n.open({message:i||"\u7f51\u7edc\u6ce2\u52a8,\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458!",type:"error"}),[401].includes(a)&&(console.log(o.N),null===o.N||void 0===o.N||null===(t=o.N.current)||void 0===t||t.logout())),r}),(function(e){return Promise.reject(e)}));var s=c,l=t(2791),f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,u.Z)({method:"get",responseType:"json"},e),t=n.method,r=n.data;return["get","delete"].includes(t)&&(n.params=r),s(n)},d=function(e){var n=(0,l.useState)(""),t=(0,r.Z)(n,2),u=t[0],i=t[1],a=(0,l.useState)(!0),o=(0,r.Z)(a,2),c=o[0],s=o[1],d=(0,l.useState)(!1),v=(0,r.Z)(d,2),p=v[0],m=v[1];return c&&f(e).then((function(e){i(e)})).catch((function(e){i(e),m(!0)})).finally((function(){s(!1)})),{data:u,isLoading:c,isCatch:p}}},9599:function(e,n,t){"use strict";t.d(n,{Ju:function(){return u}});var r=t(4973),u=function(e){return(0,r.hj)({url:"exam/personnel/paper/mock/getCertificateInfo",method:"get",data:e})};n.ZP={adminUrl:function(e){return(0,r.hj)({url:"/config/adminUrl",method:"get",data:e})},userInfo:function(e){return(0,r.hj)({url:"/user/me",method:"get",data:e})},userBase:function(e){return(0,r.hj)({url:"/user/detail",method:"get",data:e})},nextExam:function(e){return(0,r.hj)({url:"/examStatistic/nextSchedule",method:"get",data:e})},signTrain:function(e){return(0,r.hj)({url:"/learnStatistic/personnelCourse",method:"get"})},signExam:function(e){return(0,r.hj)({url:"/examStatistic/examScheduleCount",method:"get"})},getCertificateInfo:u,train:function(e){return(0,r.hj)({url:"/courseSign/personnel",method:"get",data:e})},trainDetail:function(e){return(0,r.hj)({url:"/courseSign/personnel/".concat(e.id),method:"get"})},trainDetailVideo:function(e){return(0,r.hj)({url:"/video/personnel/".concat(e.id,"/").concat(e.videoId),method:"get"})},trainDetailVideoUrl:function(e){return(0,r.hj)({url:"/video/playInfo/".concat(e.vid),method:"get"})},exam:function(e){return(0,r.hj)({url:"/examSign/personnel",method:"get"})},getExamPaper:function(e){return(0,r.hj)({url:"/exam/personnel/paper/mock/list/".concat(e.id),method:"get"})},getExamPaperDetail:function(e){return(0,r.hj)({url:"/exam/personnel/paper/mock/".concat(e.id),method:"get"})},getExamPaperAnswerDetail:function(e){return(0,r.hj)({url:"/exam/personnel/paper/mock/answer/".concat(e.id),method:"get"})}}},7507:function(e,n,t){"use strict";t.d(n,{U0:function(){return h},TG:function(){return x},lY:function(){return g},gl:function(){return f},OU:function(){return v},_i:function(){return d},_g:function(){return p},nG:function(){return m},ZR:function(){return y},KV:function(){return l}});var r=t(1413),u=t(5987),i=t(3433),a=t(4489),o=t(9599),c=["queryFn","variables"];function s(e){var n=function(n){var t=e.queryKey;return[].concat((0,i.Z)("function"===typeof t?t():t),(0,i.Z)(n?[JSON.parse(JSON.stringify(n))]:[]))},t=function(t){var i=(0,r.Z)((0,r.Z)({},e),t),s=i.queryFn,l=i.variables,f=(0,u.Z)(i,c),d=o.ZP;return(0,a.a)((0,r.Z)({queryKey:n(l),queryFn:function(e){return s((0,r.Z)((0,r.Z)({},e),{},{apis:d,variables:l}))}},f))};return t.select=function(n){return function(u){var i=(0,r.Z)((0,r.Z)((0,r.Z)({},e),u),{},{select:n});return t(i)}},t.getKey=n,t}s({queryKey:["adminUrl"],queryFn:function(e){return e.apis.adminUrl()}}),s({queryKey:["userInfo"],queryFn:function(e){return e.apis.userInfo()}});var l=s({queryKey:["userBase"],queryFn:function(e){return e.apis.userBase()}}).select((function(e){return e.data})),f=s({queryKey:["nextExam"],queryFn:function(e){return e.apis.nextExam()}}).select((function(e){return e.data})),d=s({queryKey:["signTrain"],queryFn:function(e){return e.apis.signTrain()}}),v=s({queryKey:["signExam"],queryFn:function(e){return e.apis.signExam()}}),p=(s({queryKey:["certificateInfo"],queryFn:function(e){var n=e.apis,t=e.variables;return n.getCertificateInfo(t)}}),s({queryKey:["train"],queryFn:function(e){return e.apis.train()}})),m=s({queryKey:["trainDetail"],queryFn:function(e){var n=e.apis,t=e.variables;return n.trainDetail(t)}}),y=s({queryKey:["trainDetailVideo"],queryFn:function(e){var n=e.apis,t=e.variables;return n.trainDetailVideo(t)}}),h=(s({queryKey:["trainDetailVideoUrl"],queryFn:function(e){var n=e.apis,t=e.variables;return n.trainDetailVideoUrl(t)}}).select((function(e){var n=e.data,t=n.code,r=n.playInfo.playInfoList[0].playURL;return"".concat(r,"?MtsHlsUriToken=").concat(t)})),s({queryKey:["exam"],queryFn:function(e){return e.apis.exam()}})),g=(s({queryKey:["examPaper"],queryFn:function(e){var n=e.apis,t=e.variables;return n.getExamPaper(t)}}),s({queryKey:["examPaperDetail"],queryFn:function(e){var n=e.apis,t=e.variables;return n.getExamPaperDetail(t)}})),x=s({queryKey:["examPaperDetail"],queryFn:function(e){var n=e.apis,t=e.variables;return n.getExamPaperAnswerDetail(t)}})},6633:function(e,n,t){"use strict";var r=t(4836);n.Z=void 0;var u=r(t(5649)),i=t(184),a=(0,u.default)((0,i.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),"Autorenew");n.Z=a},1428:function(e,n,t){"use strict";var r=t(4836);n.Z=void 0;var u=r(t(5649)),i=t(184),a=(0,u.default)((0,i.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}),"Done");n.Z=a},5649:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=t(8362)},7958:function(e,n,t){"use strict";t.d(n,{Z:function(){return r}});var r=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.reduce((function(e,n){return null==n?e:function(){for(var t=arguments.length,r=new Array(t),u=0;u<t;u++)r[u]=arguments[u];e.apply(this,r),n.apply(this,r)}}),(function(){}))}},8362:function(e,n,t){"use strict";t.r(n),t.d(n,{capitalize:function(){return u.Z},createChainedFunction:function(){return i.Z},createSvgIcon:function(){return a.Z},debounce:function(){return o.Z},deprecatedPropType:function(){return c},isMuiElement:function(){return s.Z},ownerDocument:function(){return l.Z},ownerWindow:function(){return f.Z},requirePropFactory:function(){return d},setRef:function(){return v},unstable_ClassNameGenerator:function(){return b},unstable_useEnhancedEffect:function(){return p.Z},unstable_useId:function(){return m.Z},unsupportedProp:function(){return y},useControlled:function(){return h.Z},useEventCallback:function(){return g.Z},useForkRef:function(){return x.Z},useIsFocusVisible:function(){return Z.Z}});var r=t(1816),u=t(4036),i=t(7958),a=t(4223),o=t(1684);var c=function(e,n){return function(){return null}},s=t(8502),l=t(8301),f=t(346);t(7462);var d=function(e,n){return function(){return null}},v=t(1032).Z,p=t(162),m=t(7384);var y=function(e,n,t,r,u){return null},h=t(3122),g=t(6161),x=t(419),Z=t(910),b={configure:function(e){r.Z.configure(e)}}},8502:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var r=t(2791);var u=function(e,n){return r.isValidElement(e)&&-1!==n.indexOf(e.type.muiName)}},4836:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);
//# sourceMappingURL=141.3df235ee.chunk.js.map